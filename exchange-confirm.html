<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Exchange Confirm | ReShelf</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
body {
  background: url('library2.jpg') center/cover no-repeat;
  background-size: cover;
  min-height: 100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  font-family:'Lora', serif;
  color:#F5F2E7;
}
.glass {
  background: rgba(0,0,0,0.6);
  backdrop-filter: blur(12px);
  border:1px solid rgba(255,255,255,0.2);
  padding:2rem;
  border-radius:1rem;
  max-width:400px;
  text-align:center;
  box-shadow:0 8px 20px rgba(0,0,0,0.4);
}
.btn {
  margin-top:1.5rem;
  background-color:#22c55e;
  padding:0.75rem 1.5rem;
  border-radius:0.5rem;
  font-weight:bold;
  cursor:pointer;
  transition:background 0.3s;
}
.btn:hover { background-color:#16a34a; }
h2 { font-size:1.8rem; margin-bottom:1rem; color:#D4AF37; }
p { margin:0.5rem 0; }
span { font-weight:bold; color:#22c55e; }
</style>
</head>
<body>

<div class="glass">
  <h2>Exchange Confirmed ✅</h2>
  <p id="bookTitle">Book: </p>
  <p id="bookAuthor">Author: </p>
  <p>Location: <span id="location"></span></p>
  <p>Time: <span id="time"></span></p>
  <button class="btn" onclick="window.location.href='home.html'">Back to Home</button>
</div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="supabase.js"></script>
<script>
async function loadExchangeInfo() {
  const { data: sessionData } = await supabaseClient.auth.getSession();
  if (!sessionData.session) { window.location.href = "auth.html"; return; }

  const urlParams = new URLSearchParams(window.location.search);
  const requestId = urlParams.get("request");
  if (!requestId) { alert("Invalid request ❌"); return; }

  const { data: req, error } = await supabaseClient
    .from("requests")
    .select("*")
    .eq("id", requestId)
    .single();

  if (error || !req) { alert("Request not found ❌"); console.error(error); return; }

  const { data: book } = await supabaseClient
    .from("books")
    .select("*")
    .eq("id", req.book_id)
    .single();

  document.getElementById("bookTitle").textContent = `Book: ${book.title}`;
  document.getElementById("bookAuthor").textContent = `Author: ${book.author}`;
  document.getElementById("location").textContent = req.exchange_location || "Not assigned";
  document.getElementById("time").textContent = req.exchange_time || "Not assigned";
}

loadExchangeInfo();
</script>

</body>
</html>



